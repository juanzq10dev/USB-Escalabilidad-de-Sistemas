DROP TABLE IF EXISTS sales;

CREATE TABLE sales (
    sale_date DATE,
    amount DECIMAL(10, 2)
) 
PARTITION BY LIST (MONTH(sale_date)) (
    PARTITION p_january VALUES IN (1),
    PARTITION p_february VALUES IN (2),
    PARTITION p_march VALUES IN (3),
    PARTITION p_april VALUES IN (4),
    PARTITION p_may VALUES IN (5),
    PARTITION p_june VALUES IN (6),
    PARTITION p_july VALUES IN (7),
    PARTITION p_august VALUES IN (8),
    PARTITION p_september VALUES IN (9),
    PARTITION p_october VALUES IN (10),
    PARTITION p_november VALUES IN (11),
    PARTITION p_december VALUES IN (12)
);

INSERT INTO sales (sale_date, amount) VALUES
('2024-01-01', 100.00),
('2024-01-02', 150.50),
('2024-01-03', 200.25),
('2024-01-04', 175.75),
('2024-01-05', 300.00),
('2024-01-06', 125.50),
('2024-01-07', 80.25),
('2024-01-08', 220.75),
('2024-01-09', 275.00),
('2024-01-10', 150.25),
('2024-02-10', 210.25),
('2024-02-11', 185.00),
('2024-02-12', 140.50),
('2024-02-13', 165.25),
('2024-02-14', 200.75),
('2024-02-15', 240.00),
('2024-02-16', 195.50),
('2024-02-17', 180.25),
('2024-03-12', 270.50),
('2024-03-13', 190.25),
('2024-03-14', 205.75),
('2024-03-15', 250.00),
('2024-03-16', 265.50),
('2024-03-17', 210.25),
('2024-03-18', 230.75),
('2024-03-19', 220.00),
('2024-04-06', 275.50),
('2024-04-07', 230.25),
('2024-04-08', 245.75),
('2024-04-09', 270.00),
('2024-04-10', 285.25),
('2024-04-11', 300.00),
('2024-04-12', 275.50),
('2024-04-13', 250.25),
('2024-05-13', 70.25),
('2024-05-14', 55.75),
('2024-05-15', 40.00),
('2024-05-16', 25.50),
('2024-05-17', 10.25),
('2024-05-18', 5.75),
('2024-05-19', 20.00),
('2024-06-10', 185.25),
('2024-06-11', 200.00),
('2024-06-12', 215.50),
('2024-06-13', 230.25),
('2024-06-14', 245.75),
('2024-06-15', 260.00),
('2024-06-16', 275.50),
('2024-06-17', 290.25),
('2024-06-18', 305.75),
('2024-12-04', 305.75),
('2024-12-05', 290.00),
('2024-12-06', 275.50),
('2024-12-07', 260.25),
('2024-12-08', 245.75);

SELECT * FROM sales;

SELECT * FROM sales PARTITION (p_january);
SELECT * FROM sales PARTITION (p_february);
SELECT * FROM sales PARTITION (p_december);
